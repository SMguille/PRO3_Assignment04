# Threat Model – Slaughterhouse System

## 1. Scope and Assets

Critical assets to protect:

* **Animal & product registration data** – source of truth for recalls.
* **Recall functionality** – externally accessible and must be trustworthy.
* **Operational continuity of each station** – weighing, cutting, packing must continue even if the network is down.

## 2. Actors

* **Internal operators** – staff at Station 1–3.
* **External recall client** – supermarket or authority triggering a recall.
* **Maintenance staff** – privileged internal users.
* **Malicious outsiders** – attackers seeking to tamper with data or disrupt operations.

## 3. Trust Boundaries

* **Internal network boundary** – encloses Station 1–3, internal services and database.
* **External boundary** – separates external recall client from the internal network.

---

## 4. Architecture & Data Flows

```
+---------------------+              +------------------------+
| External Recall     |  HTTPS API   | Recall Service         |
| Client (authority)  +------------->+ (exposed endpoint)     |
+---------------------+              +------------------------+
                                              |
                                              | Internal message bus
                                              v
+-------------+   +-------------+   +-------------+        +------------------+
| Station 1   |   | Station 2   |   | Station 3   |  -----> | Slaughterhouse   |
| Weigh & Reg |   | Cutting     |   | Packing     |         | Database         |
+-------------+   +-------------+   +-------------+        +------------------+
```

*Dashed rectangle (not shown in plain text) indicates internal network trust boundary.*

---

## 5. STRIDE-Based Threat Analysis

| Component / Flow                | STRIDE Category            | Threat Example                                 | Mitigation                                   |
| ------------------------------- | -------------------------- | ---------------------------------------------- | -------------------------------------------- |
| **External recall API**         | **Spoofing**               | Fake recall request by unauthorized party      | Mutual TLS, API keys                         |
|                                 | **Tampering**              | Alter recall instructions in transit           | TLS encryption                               |
|                                 | **Denial of Service**      | Flooding recall endpoint                       | Rate limiting, WAF                           |
| **Database**                    | **Tampering**              | Unauthorized changes to product/animal records | RBAC, audit logging, backups                 |
|                                 | **Repudiation**            | Operator denies having changed a record        | Signed audit trails                          |
| **Inter-station communication** | **Denial of Service**      | Network outage halts workflow                  | Local buffering, asynchronous queues         |
| **Operator login at stations**  | **Elevation of Privilege** | Compromise of admin credentials                | MFA, strong password policies                |
| **Maintenance access**          | **Information Disclosure** | Leakage of sensitive product trace data        | Encrypt data at rest, least-privilege access |

---

## 6. Mitigation Summary

* **Authentication & Authorization:** Mutual TLS for external recall API; role-based access control for internal services.
* **Confidentiality & Integrity:** TLS for all data flows; database encryption and signed audit logs.
* **Availability:** Local queueing at stations to allow offline operation; DoS protection at external endpoints.
* **Monitoring & Response:** Centralized logging, intrusion detection, automated alerting.

---

> **Outcome:** This threat model identifies critical assets, actors, trust boundaries, and enumerates threats under the STRIDE categories with corresponding mitigations, providing a concise security blueprint for the slaughterhouse system.
